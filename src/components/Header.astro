---
interface Props {
  currentPath?: string;
}

const { currentPath = '/' } = Astro.props;

const navItems = [
  { href: '#about', label: '关于我' },
  { href: '#blog', label: '博客' },
  { href: '#services', label: '服务' },
  { href: '#cases', label: '案例' },
];
---

<header class="glass sticky top-0 z-50 border-b border-border/30">
  <div class="container py-4 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-3 group">
      <div class="w-11 h-11 rounded-xl bg-gradient-to-br from-accent to-purple-600 flex items-center justify-center text-white font-bold text-lg shadow-lg shadow-accent/30 group-hover:shadow-accent/50 transition-all duration-300 group-hover:scale-105">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
      </div>
      <div class="hidden sm:block">
        <span class="text-lg font-bold text-text-primary">邱小亮</span>
        <span class="block text-xs text-text-secondary">AI × 健康数字化</span>
      </div>
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex items-center gap-6">
      {navItems.map((item) => (
        <a
          href={item.href}
          class="text-text-secondary hover:text-accent transition-colors duration-200 text-sm font-medium relative group"
        >
          {item.label}
          <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-gradient-to-r from-accent to-purple-600 group-hover:w-full transition-all duration-300"></span>
        </a>
      ))}

      <!-- Theme Toggle -->
      <button
        id="theme-toggle"
        class="p-2 rounded-lg bg-surface border border-border hover:border-accent transition-all duration-300"
        aria-label="切换主题"
      >
        <svg id="sun-icon" class="w-5 h-5 text-primary hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
        <svg id="moon-icon" class="w-5 h-5 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
        </svg>
      </button>

      <a
        href="#contact"
        class="btn btn-accent text-sm px-5"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        立即咨询
      </a>
    </nav>

    <!-- Mobile Menu Button -->
    <div class="md:hidden flex items-center gap-2">
      <!-- Mobile Theme Toggle -->
      <button
        id="theme-toggle-mobile"
        class="p-2 rounded-lg bg-surface border border-border hover:border-accent transition-all duration-300"
        aria-label="切换主题"
      >
        <svg id="sun-icon-mobile" class="w-5 h-5 text-primary hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
        <svg id="moon-icon-mobile" class="w-5 h-5 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
        </svg>
      </button>

      <button
        id="mobile-menu-btn"
        class="p-2 rounded-lg bg-surface border border-border hover:border-accent transition-colors"
        aria-label="打开菜单"
      >
        <svg class="w-6 h-6 text-text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path id="menu-icon-open" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          <path id="menu-icon-close" class="hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile Navigation -->
  <div
    id="mobile-menu"
    class="md:hidden hidden glass border-t border-border/30"
  >
    <nav class="container py-4 flex flex-col gap-2">
      {navItems.map((item) => (
        <a
          href={item.href}
          class="mobile-nav-link text-text-secondary hover:text-accent hover:bg-accent/10 px-4 py-3 rounded-lg transition-colors duration-200 flex items-center gap-3"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
          </svg>
          {item.label}
        </a>
      ))}
      <a
        href="#contact"
        class="btn btn-accent text-sm mx-4 mt-2"
      >
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
        立即咨询
      </a>
    </nav>
  </div>
</header>

<script>
  // Theme Toggle
  function initTheme() {
    const theme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

    if (theme === 'dark' || (!theme && prefersDark)) {
      document.documentElement.classList.add('dark');
      updateThemeIcons(true);
    } else {
      updateThemeIcons(false);
    }
  }

  function updateThemeIcons(isDark: boolean) {
    const sunIcons = document.querySelectorAll('#sun-icon, #sun-icon-mobile');
    const moonIcons = document.querySelectorAll('#moon-icon, #moon-icon-mobile');

    sunIcons.forEach(icon => {
      icon.classList.toggle('hidden', !isDark);
    });
    moonIcons.forEach(icon => {
      icon.classList.toggle('hidden', isDark);
    });
  }

  function toggleTheme() {
    const isDark = document.documentElement.classList.toggle('dark');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
    updateThemeIcons(isDark);
  }

  // Initialize theme on load
  initTheme();

  // Theme toggle buttons
  document.getElementById('theme-toggle')?.addEventListener('click', toggleTheme);
  document.getElementById('theme-toggle-mobile')?.addEventListener('click', toggleTheme);

  // Mobile Menu Toggle
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const openIcon = document.getElementById('menu-icon-open');
  const closeIcon = document.getElementById('menu-icon-close');
  const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');

  if (menuBtn && mobileMenu && openIcon && closeIcon) {
    menuBtn.addEventListener('click', () => {
      const isOpen = !mobileMenu.classList.contains('hidden');

      if (isOpen) {
        mobileMenu.classList.add('hidden');
        openIcon.classList.remove('hidden');
        closeIcon.classList.add('hidden');
        menuBtn.setAttribute('aria-label', '打开菜单');
      } else {
        mobileMenu.classList.remove('hidden');
        openIcon.classList.add('hidden');
        closeIcon.classList.remove('hidden');
        menuBtn.setAttribute('aria-label', '关闭菜单');
      }
    });

    // 点击导航链接后关闭菜单
    mobileNavLinks.forEach((link) => {
      link.addEventListener('click', () => {
        mobileMenu.classList.add('hidden');
        openIcon.classList.remove('hidden');
        closeIcon.classList.add('hidden');
        menuBtn.setAttribute('aria-label', '打开菜单');
      });
    });
  }
</script>
